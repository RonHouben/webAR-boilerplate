{"version":3,"sources":["js/threex/threex.artoolkitcontext.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["ARjs","THREEx","Context","ArToolkitContext","parameters","_this","_updatedAt","trackingBackend","debug","detectionMode","matrixCodeType","cameraParametersUrl","baseURL","maxDetectionRate","canvasWidth","canvasHeight","patternRatio","imageSmoothingEnabled","console","assert","indexOf","arController","arucoContext","initialized","_arMarkersControls","setParameters","undefined","key","newValue","warn","currentValue","Object","assign","prototype","THREE","EventDispatcher","REVISION","createDefaultCamera","camera","Camera","PerspectiveCamera","renderer","domElement","width","height","init","onCompleted","_initArtoolkit","done","_initAruco","_initTango","dispatchEvent","type","update","srcElement","present","performance","now","forEach","markerControls","object3d","visible","_updateArtoolkit","_updateAruco","_updateTango","addMarker","arMarkerControls","ArMarkerControls","push","removeMarker","index","arMarkerControlss","artoolkitMarker","splice","_artoolkitProjectionAxisTransformMatrix","Matrix4","multiply","makeRotationY","Math","PI","makeRotationZ","cameraParameters","ARCameraParam","ARController","ctx","mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled","debugSetup","canvas","style","position","top","opacity","pointerEvents","zIndex","detectionModes","artoolkit","AR_TEMPLATE_MATCHING_COLOR","AR_TEMPLATE_MATCHING_COLOR_AND_MATRIX","AR_TEMPLATE_MATCHING_MONO","AR_TEMPLATE_MATCHING_MONO_AND_MATRIX","setPatternDetectionMode","matrixCodeTypes","AR_MATRIX_CODE_3x3","AR_MATRIX_CODE_3x3_HAMMING63","AR_MATRIX_CODE_3x3_PARITY65","AR_MATRIX_CODE_4x4","AR_MATRIX_CODE_4x4_BCH_13_9_3","AR_MATRIX_CODE_4x4_BCH_13_5_5","setMatrixCodeType","setPattRatio","getProjectionMatrix","projectionMatrixArr","getCameraMatrix","projectionMatrix","fromArray","process","ArucoContext","context","getContext","setTimeout","arMarkersControls","detectedMarkers","detect","detectedMarker","foundControls","i","length","barcodeValue","id","tmpObject3d","Object3D","updateObject3D","_arucoPosit","size","updateMatrix","updateWithModelViewMatrix","matrix","navigator","getVRDisplays","getVRDevices","alert","_tangoContext","vrDisplay","vrPointCloud","frameData","VRFrameData","then","vrDisplays","log","displayName","WebAR","VRPointCloud","tangoContext","showPointCloud","pointsToSkip","getFrameData","pose","orientation","Vector3","quaternion","Quaternion","scale","cameraTransformMatrix","compose","modelViewMatrix","getInverse","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","v","hmrAcceptRun","window","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"threex.artoolkitcontext.bba6e859.js","sourceRoot":"../src","sourcesContent":["var ARjs = ARjs || {}\nvar THREEx = THREEx || {}\n\nARjs.Context = THREEx.ArToolkitContext = function(parameters){\n\tvar _this = this\n\n\t_this._updatedAt = null\n\n\t// handle default parameters\n\tthis.parameters = {\n\t\t// AR backend - ['artoolkit', 'aruco', 'tango']\n\t\ttrackingBackend: 'artoolkit',\n\t\t// debug - true if one should display artoolkit debug canvas, false otherwise\n\t\tdebug: false,\n\t\t// the mode of detection - ['color', 'color_and_matrix', 'mono', 'mono_and_matrix']\n\t\tdetectionMode: 'mono',\n\t\t// type of matrix code - valid iif detectionMode end with 'matrix' - [3x3, 3x3_HAMMING63, 3x3_PARITY65, 4x4, 4x4_BCH_13_9_3, 4x4_BCH_13_5_5]\n\t\tmatrixCodeType: '3x3',\n\n\t\t// url of the camera parameters\n\t\tcameraParametersUrl: ARjs.Context.baseURL + 'parameters/camera_para.dat',\n\n\t\t// tune the maximum rate of pose detection in the source image\n\t\tmaxDetectionRate: 60,\n\t\t// resolution of at which we detect pose in the source image\n\t\tcanvasWidth: 640,\n\t\tcanvasHeight: 480,\n\n\t\t// the patternRatio inside the artoolkit marker - artoolkit only\n\t\tpatternRatio: 0.5,\n\n\t\t// enable image smoothing or not for canvas copy - default to true\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/imageSmoothingEnabled\n\t\timageSmoothingEnabled : false,\n\t}\n\t// parameters sanity check\n\tconsole.assert(['artoolkit', 'aruco', 'tango'].indexOf(this.parameters.trackingBackend) !== -1, 'invalid parameter trackingBackend', this.parameters.trackingBackend)\n\tconsole.assert(['color', 'color_and_matrix', 'mono', 'mono_and_matrix'].indexOf(this.parameters.detectionMode) !== -1, 'invalid parameter detectionMode', this.parameters.detectionMode)\n\n        this.arController = null;\n        this.arucoContext = null;\n\n\t_this.initialized = false\n\n\n\tthis._arMarkersControls = []\n\n\t//////////////////////////////////////////////////////////////////////////////\n\t//\t\tsetParameters\n\t//////////////////////////////////////////////////////////////////////////////\n\tsetParameters(parameters)\n\tfunction setParameters(parameters){\n\t\tif( parameters === undefined )\treturn\n\t\tfor( var key in parameters ){\n\t\t\tvar newValue = parameters[ key ]\n\n\t\t\tif( newValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArToolkitContext: '\" + key + \"' parameter is undefined.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tvar currentValue = _this.parameters[ key ]\n\n\t\t\tif( currentValue === undefined ){\n\t\t\t\tconsole.warn( \"THREEx.ArToolkitContext: '\" + key + \"' is not a property of this material.\" )\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t_this.parameters[ key ] = newValue\n\t\t}\n\t}\n}\n\nObject.assign( ARjs.Context.prototype, THREE.EventDispatcher.prototype );\n\n// ARjs.Context.baseURL = '../'\n// default to github page\nARjs.Context.baseURL = 'https://jeromeetienne.github.io/AR.js/three.js/'\nARjs.Context.REVISION = '1.6.0'\n\n\n\n/**\n * Create a default camera for this trackingBackend\n * @param {string} trackingBackend - the tracking to user\n * @return {THREE.Camera} the created camera\n */\nARjs.Context.createDefaultCamera = function( trackingBackend ){\n\tconsole.assert(false, 'use ARjs.Utils.createDefaultCamera instead')\n\t// Create a camera\n\tif( trackingBackend === 'artoolkit' ){\n\t\tvar camera = new THREE.Camera();\n\t}else if( trackingBackend === 'aruco' ){\n\t\tvar camera = new THREE.PerspectiveCamera(42, renderer.domElement.width / renderer.domElement.height, 0.01, 100);\n\t}else if( trackingBackend === 'tango' ){\n\t\tvar camera = new THREE.PerspectiveCamera(42, renderer.domElement.width / renderer.domElement.height, 0.01, 100);\n\t}else console.assert(false)\n\treturn camera\n}\n\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tinit functions\n//////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype.init = function(onCompleted){\n\tvar _this = this\n\tif( this.parameters.trackingBackend === 'artoolkit' ){\n\t\tthis._initArtoolkit(done)\n\t}else if( this.parameters.trackingBackend === 'aruco' ){\n\t\tthis._initAruco(done)\n\t}else if( this.parameters.trackingBackend === 'tango' ){\n\t\tthis._initTango(done)\n\t}else console.assert(false)\n\treturn\n\n\tfunction done(){\n\t\t// dispatch event\n\t\t_this.dispatchEvent({\n\t\t\ttype: 'initialized'\n\t\t});\n\n\t\t_this.initialized = true\n\n\t\tonCompleted && onCompleted()\n\t}\n\n}\n////////////////////////////////////////////////////////////////////////////////\n//          update function\n////////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype.update = function(srcElement){\n\n\t// be sure arController is fully initialized\n        if(this.parameters.trackingBackend === 'artoolkit' && this.arController === null) return false;\n\n\t// honor this.parameters.maxDetectionRate\n\tvar present = performance.now()\n\tif( this._updatedAt !== null && present - this._updatedAt < 1000/this.parameters.maxDetectionRate ){\n\t\treturn false\n\t}\n\tthis._updatedAt = present\n\n\t// mark all markers to invisible before processing this frame\n\tthis._arMarkersControls.forEach(function(markerControls){\n\t\tmarkerControls.object3d.visible = false\n\t})\n\n\t// process this frame\n\tif(this.parameters.trackingBackend === 'artoolkit'){\n\t\tthis._updateArtoolkit(srcElement)\n\t}else if( this.parameters.trackingBackend === 'aruco' ){\n\t\tthis._updateAruco(srcElement)\n\t}else if( this.parameters.trackingBackend === 'tango' ){\n\t\tthis._updateTango(srcElement)\n\t}else{\n\t\tconsole.assert(false)\n\t}\n\n\t// dispatch event\n\tthis.dispatchEvent({\n\t\ttype: 'sourceProcessed'\n\t});\n\n\n\t// return true as we processed the frame\n\treturn true;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n//          Add/Remove markerControls\n////////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype.addMarker = function(arMarkerControls){\n\tconsole.assert(arMarkerControls instanceof THREEx.ArMarkerControls)\n\tthis._arMarkersControls.push(arMarkerControls)\n}\n\nARjs.Context.prototype.removeMarker = function(arMarkerControls){\n\tconsole.assert(arMarkerControls instanceof THREEx.ArMarkerControls)\n\t// console.log('remove marker for', arMarkerControls)\n\tvar index = this.arMarkerControlss.indexOf(artoolkitMarker);\n\tconsole.assert(index !== index )\n\tthis._arMarkersControls.splice(index, 1)\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\tartoolkit specific\n//////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype._initArtoolkit = function(onCompleted){\n        var _this = this\n\n\t// set this._artoolkitProjectionAxisTransformMatrix to change artoolkit projection matrix axis to match usual webgl one\n\tthis._artoolkitProjectionAxisTransformMatrix = new THREE.Matrix4()\n\tthis._artoolkitProjectionAxisTransformMatrix.multiply(new THREE.Matrix4().makeRotationY(Math.PI))\n\tthis._artoolkitProjectionAxisTransformMatrix.multiply(new THREE.Matrix4().makeRotationZ(Math.PI))\n\n\t// get cameraParameters\n        var cameraParameters = new ARCameraParam(_this.parameters.cameraParametersUrl, function(){\n        \t// init controller\n                var arController = new ARController(_this.parameters.canvasWidth, _this.parameters.canvasHeight, cameraParameters);\n                _this.arController = arController\n\n\t\t// honor this.parameters.imageSmoothingEnabled\n\t\tarController.ctx.mozImageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\t\tarController.ctx.webkitImageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\t\tarController.ctx.msImageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\t\tarController.ctx.imageSmoothingEnabled = _this.parameters.imageSmoothingEnabled;\n\n\t\t// honor this.parameters.debug\n                if( _this.parameters.debug === true ){\n\t\t\tarController.debugSetup();\n\t\t\tarController.canvas.style.position = 'absolute'\n\t\t\tarController.canvas.style.top = '0px'\n\t\t\tarController.canvas.style.opacity = '0.6'\n\t\t\tarController.canvas.style.pointerEvents = 'none'\n\t\t\tarController.canvas.style.zIndex = '-1'\n\t\t}\n\n\t\t// setPatternDetectionMode\n\t\tvar detectionModes = {\n\t\t\t'color'\t\t\t: artoolkit.AR_TEMPLATE_MATCHING_COLOR,\n\t\t\t'color_and_matrix'\t: artoolkit.AR_TEMPLATE_MATCHING_COLOR_AND_MATRIX,\n\t\t\t'mono'\t\t\t: artoolkit.AR_TEMPLATE_MATCHING_MONO,\n\t\t\t'mono_and_matrix'\t: artoolkit.AR_TEMPLATE_MATCHING_MONO_AND_MATRIX,\n\t\t}\n\t\tvar detectionMode = detectionModes[_this.parameters.detectionMode]\n\t\tconsole.assert(detectionMode !== undefined)\n\t\tarController.setPatternDetectionMode(detectionMode);\n\n\t\t// setMatrixCodeType\n\t\tvar matrixCodeTypes = {\n\t\t\t'3x3'\t\t: artoolkit.AR_MATRIX_CODE_3x3,\n\t\t\t'3x3_HAMMING63'\t: artoolkit.AR_MATRIX_CODE_3x3_HAMMING63,\n\t\t\t'3x3_PARITY65'\t: artoolkit.AR_MATRIX_CODE_3x3_PARITY65,\n\t\t\t'4x4'\t\t: artoolkit.AR_MATRIX_CODE_4x4,\n\t\t\t'4x4_BCH_13_9_3': artoolkit.AR_MATRIX_CODE_4x4_BCH_13_9_3,\n\t\t\t'4x4_BCH_13_5_5': artoolkit.AR_MATRIX_CODE_4x4_BCH_13_5_5,\n\t\t}\n\t\tvar matrixCodeType = matrixCodeTypes[_this.parameters.matrixCodeType]\n\t\tconsole.assert(matrixCodeType !== undefined)\n\t\tarController.setMatrixCodeType(matrixCodeType);\n\n\t\t// set the patternRatio for artoolkit\n\t\tarController.setPattRatio(_this.parameters.patternRatio);\n\n\t\t// set thresholding in artoolkit\n\t\t// this seems to be the default\n\t\t// arController.setThresholdMode(artoolkit.AR_LABELING_THRESH_MODE_MANUAL)\n\t\t// adatative consume a LOT of cpu...\n\t\t// arController.setThresholdMode(artoolkit.AR_LABELING_THRESH_MODE_AUTO_ADAPTIVE)\n\t\t// arController.setThresholdMode(artoolkit.AR_LABELING_THRESH_MODE_AUTO_OTSU)\n\n\t\t// notify\n                onCompleted()\n        })\n\treturn this\n}\n\n/**\n * return the projection matrix\n */\nARjs.Context.prototype.getProjectionMatrix = function(srcElement){\n\n\n// FIXME rename this function to say it is artoolkit specific - getArtoolkitProjectMatrix\n// keep a backward compatibility with a console.warn\n\n\tconsole.assert( this.parameters.trackingBackend === 'artoolkit' )\n\tconsole.assert(this.arController, 'arController MUST be initialized to call this function')\n\t// get projectionMatrixArr from artoolkit\n\tvar projectionMatrixArr = this.arController.getCameraMatrix();\n\tvar projectionMatrix = new THREE.Matrix4().fromArray(projectionMatrixArr)\n\n\t// apply context._axisTransformMatrix - change artoolkit axis to match usual webgl one\n\tprojectionMatrix.multiply(this._artoolkitProjectionAxisTransformMatrix)\n\n\t// return the result\n\treturn projectionMatrix\n}\n\nARjs.Context.prototype._updateArtoolkit = function(srcElement){\n\tthis.arController.process(srcElement)\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\taruco specific\n//////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype._initAruco = function(onCompleted){\n\tthis.arucoContext = new THREEx.ArucoContext()\n\n\t// honor this.parameters.canvasWidth/.canvasHeight\n\tthis.arucoContext.canvas.width = this.parameters.canvasWidth\n\tthis.arucoContext.canvas.height = this.parameters.canvasHeight\n\n\t// honor this.parameters.imageSmoothingEnabled\n\tvar context = this.arucoContext.canvas.getContext('2d')\n\t// context.mozImageSmoothingEnabled = this.parameters.imageSmoothingEnabled;\n\tcontext.webkitImageSmoothingEnabled = this.parameters.imageSmoothingEnabled;\n\tcontext.msImageSmoothingEnabled = this.parameters.imageSmoothingEnabled;\n\tcontext.imageSmoothingEnabled = this.parameters.imageSmoothingEnabled;\n\n\n\tsetTimeout(function(){\n\t\tonCompleted()\n\t}, 0)\n}\n\n\nARjs.Context.prototype._updateAruco = function(srcElement){\n\t// console.log('update aruco here')\n\tvar _this = this\n\tvar arMarkersControls = this._arMarkersControls\n        var detectedMarkers = this.arucoContext.detect(srcElement)\n\n\tdetectedMarkers.forEach(function(detectedMarker){\n\t\tvar foundControls = null\n\t\tfor(var i = 0; i < arMarkersControls.length; i++){\n\t\t\tconsole.assert( arMarkersControls[i].parameters.type === 'barcode' )\n\t\t\tif( arMarkersControls[i].parameters.barcodeValue === detectedMarker.id ){\n\t\t\t\tfoundControls = arMarkersControls[i]\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif( foundControls === null )\treturn\n\n\t\tvar tmpObject3d = new THREE.Object3D\n                _this.arucoContext.updateObject3D(tmpObject3d, foundControls._arucoPosit, foundControls.parameters.size, detectedMarker);\n\t\ttmpObject3d.updateMatrix()\n\n\t\tfoundControls.updateWithModelViewMatrix(tmpObject3d.matrix)\n\t})\n}\n\n//////////////////////////////////////////////////////////////////////////////\n//\t\ttango specific\n//////////////////////////////////////////////////////////////////////////////\nARjs.Context.prototype._initTango = function(onCompleted){\n\tvar _this = this\n\t// check webvr is available\n\tif (navigator.getVRDisplays){\n\t\t// do nothing\n\t} else if (navigator.getVRDevices){\n\t\talert(\"Your browser supports WebVR but not the latest version. See <a href='http://webvr.info'>webvr.info</a> for more info.\");\n\t} else {\n\t\talert(\"Your browser does not support WebVR. See <a href='http://webvr.info'>webvr.info</a> for assistance.\");\n\t}\n\n\n\tthis._tangoContext = {\n\t\tvrDisplay: null,\n\t\tvrPointCloud: null,\n\t\tframeData: new VRFrameData(),\n\t}\n\n\n\t// get vrDisplay\n\tnavigator.getVRDisplays().then(function (vrDisplays){\n\t\tif( vrDisplays.length === 0 )\talert('no vrDisplays available')\n\t\tvar vrDisplay = _this._tangoContext.vrDisplay = vrDisplays[0]\n\n\t\tconsole.log('vrDisplays.displayName :', vrDisplay.displayName)\n\n\t\t// init vrPointCloud\n\t\tif( vrDisplay.displayName === \"Tango VR Device\" ){\n                \t_this._tangoContext.vrPointCloud = new THREE.WebAR.VRPointCloud(vrDisplay, true)\n\t\t}\n\n\t\t// NOTE it doesnt seem necessary and it fails on tango\n\t\t// var canvasElement = document.createElement('canvas')\n\t\t// document.body.appendChild(canvasElement)\n\t\t// _this._tangoContext.requestPresent([{ source: canvasElement }]).then(function(){\n\t\t// \tconsole.log('vrdisplay request accepted')\n\t\t// });\n\n\t\tonCompleted()\n\t});\n}\n\n\nARjs.Context.prototype._updateTango = function(srcElement){\n\t// console.log('update aruco here')\n\tvar _this = this\n\tvar arMarkersControls = this._arMarkersControls\n\tvar tangoContext= this._tangoContext\n\tvar vrDisplay = this._tangoContext.vrDisplay\n\n\t// check vrDisplay is already initialized\n\tif( vrDisplay === null )\treturn\n\n\n        // Update the point cloud. Only if the point cloud will be shown the geometry is also updated.\n\tif( vrDisplay.displayName === \"Tango VR Device\" ){\n\t        var showPointCloud = true\n\t\tvar pointsToSkip = 0\n\t        _this._tangoContext.vrPointCloud.update(showPointCloud, pointsToSkip, true)\n\t}\n\n\n\tif( this._arMarkersControls.length === 0 )\treturn\n\n\t// TODO here do a fake search on barcode/1001 ?\n\n\tvar foundControls = this._arMarkersControls[0]\n\n\tvar frameData = this._tangoContext.frameData\n\n\t// read frameData\n\tvrDisplay.getFrameData(frameData);\n\n\tif( frameData.pose.position === null )\t\treturn\n\tif( frameData.pose.orientation === null )\treturn\n\n\t// create cameraTransformMatrix\n\tvar position = new THREE.Vector3().fromArray(frameData.pose.position)\n\tvar quaternion = new THREE.Quaternion().fromArray(frameData.pose.orientation)\n\tvar scale = new THREE.Vector3(1,1,1)\n\tvar cameraTransformMatrix = new THREE.Matrix4().compose(position, quaternion, scale)\n\t// compute modelViewMatrix from cameraTransformMatrix\n\tvar modelViewMatrix = new THREE.Matrix4()\n\tmodelViewMatrix.getInverse( cameraTransformMatrix )\n\n\tfoundControls.updateWithModelViewMatrix(modelViewMatrix)\n\n\t// console.log('position', position)\n\t// if( position.x !== 0 ||  position.y !== 0 ||  position.z !== 0 ){\n\t// \tconsole.log('vrDisplay tracking')\n\t// }else{\n\t// \tconsole.log('vrDisplay NOT tracking')\n\t// }\n\n}\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] âœ¨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] ðŸš¨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">ðŸš¨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}